"use strict";(self.webpackChunkmy_portfolio=self.webpackChunkmy_portfolio||[]).push([[213],{2213:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var t=a(5043),l=a(5016),i=a(6662),r=a(9956);const d={maxWidth:400,maxHeight:400,quality:.8,maxFileSize:5242880,acceptedTypes:["image/jpeg","image/png","image/webp"]},o=async(e,s)=>{try{if(e.size>d.maxFileSize)throw new Error(`\u0424\u0430\u0439\u043b \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0439. \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 ${d.maxFileSize/1024/1024}MB`);if(!d.acceptedTypes.includes(e.type))throw new Error("\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0444\u0430\u0439\u043b\u0430. \u0414\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b: JPG, PNG, WebP");const a=await(e=>new Promise((s=>{const a=new FileReader;a.readAsDataURL(e),a.onload=a=>{const t=new Image;t.src=a.target.result,t.onload=()=>{const a=document.createElement("canvas"),{maxWidth:l,maxHeight:i}=d;let r=t.width,o=t.height;r>o?r>l&&(o*=l/r,r=l):o>i&&(r*=i/o,o=i),a.width=r,a.height=o,a.getContext("2d").drawImage(t,0,0,r,o),a.toBlob((a=>{s(new File([a],e.name,{type:"image/jpeg",lastModified:Date.now()}))}),"image/jpeg",d.quality)}}})))(e),t=new FormData;t.append("file",a),t.append("upload_preset","my_portfolio_preset"),t.append("folder","avatars"),t.append("public_id",`user_${s}_${Date.now()}`),t.append("transformation","w_400,h_400,c_fill,g_face");const l=await fetch("https://api.cloudinary.com/v1_1/dkpomb0py/upload",{method:"POST",body:t});if(!l.ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f");const i=await l.json();return{url:i.secure_url,publicId:i.public_id,width:i.width,height:i.height}}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0432 Cloudinary:",a),a}};var n=a(4765);var c=a(579);const p=e=>{let{message:s,type:a="success",onClose:l,duration:i=3e3}=e;(0,t.useEffect)((()=>{const e=setTimeout((()=>{l()}),i);return()=>clearTimeout(e)}),[i,l]);const r="success"===a?"bg-green-500":"bg-red-500";return(0,c.jsx)("div",{className:"fixed inset-x-0 top-4 mx-auto z-50 flex justify-center animate-fade-in-down",children:(0,c.jsx)("div",{className:`${r} text-white px-6 py-3 rounded-lg shadow-lg max-w-sm text-center`,children:s})})},h=()=>{var e,s,a;const{user:d,logout:h,updateUserProfile:u,updateUserPassword:m}=(0,l.A)(),x=(0,i.Zp)(),[g,y]=(0,t.useState)(!1),[v,w]=(0,t.useState)({displayName:(null===d||void 0===d?void 0:d.displayName)||"",about:(null===d||void 0===d||null===(e=d.additionalData)||void 0===e?void 0:e.about)||"",skills:(null===d||void 0===d||null===(s=d.additionalData)||void 0===s?void 0:s.skills)||[]}),[j,b]=(0,t.useState)(null),[f,N]=(0,t.useState)(""),[k,C]=(0,t.useState)({show:!1,message:"",type:"success"}),[_,S]=(0,t.useState)(!1),[z,E]=(0,t.useState)(!1),F=(0,t.useRef)();(0,t.useEffect)((()=>{let e;return d&&(e=(0,n.Xd)(d.uid,(e=>{b(e),w((s=>({...s,displayName:(null===e||void 0===e?void 0:e.displayName)||d.displayName||"",about:(null===e||void 0===e?void 0:e.about)||"",skills:(null===e||void 0===e?void 0:e.skills)||[]})))}))),()=>{e&&e()}}),[d]);const P=function(e){C({show:!0,message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"})};return d?(0,c.jsxs)("div",{className:"min-h-screen bg-[#121212] pt-20",children:[k.show&&(0,c.jsx)(p,{message:k.message,type:k.type,onClose:()=>{C({show:!1,message:"",type:"success"})}}),(0,c.jsx)("div",{className:"container mx-auto px-4",children:(0,c.jsxs)("div",{className:"bg-[#1f1f1f] rounded-lg p-6 max-w-2xl mx-auto",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,c.jsx)("h2",{className:"text-2xl font-bold text-white",children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsx)("button",{onClick:()=>{x("/")},className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",children:"\u041d\u0430\u0437\u0430\u0434"}),(0,c.jsx)("button",{onClick:async()=>{S(!0);try{await h(),x("/")}catch(e){P("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437","error"),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435:",e)}finally{S(!1)}},disabled:_,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:_?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[(0,c.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,c.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938\u043b3-2.647z"})]}),"\u0412\u044b\u0445\u043e\u0434..."]}):"\u0412\u044b\u0439\u0442\u0438"})]})]}),(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsxs)("div",{className:"flex items-start gap-6",children:[(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("img",{src:(null===d||void 0===d?void 0:d.photoURL)||"https://via.placeholder.com/100",alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"w-24 h-24 rounded-full object-cover cursor-pointer "+(z?"opacity-50":""),onClick:()=>{F.current.click()}}),z&&(0,c.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,c.jsxs)("svg",{className:"animate-spin h-8 w-8 text-white",viewBox:"0 0 24 24",children:[(0,c.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,c.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938\u043b3-2.647z"})]})}),(0,c.jsx)("input",{type:"file",ref:F,onChange:async e=>{const s=e.target.files[0];if(s)try{E(!0);const e=await(async(e,s)=>{try{const a=await o(s,e);return(await(0,n.OJ)(e,a)).url}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0430\u0432\u0430\u0442\u0430\u0440\u0430:",a),a}})(d.uid,s);await u({...v,photoURL:e}),P("\u0410\u0432\u0430\u0442\u0430\u0440 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d")}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0430\u0432\u0430\u0442\u0430\u0440\u0430:",a),P(a.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0430\u0432\u0430\u0442\u0430\u0440\u0430","error")}finally{E(!1)}},accept:"image/*",className:"hidden"})]}),(0,c.jsx)("div",{className:"flex-1",children:g?(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)("input",{type:"text",value:v.displayName,onChange:e=>w({...v,displayName:e.target.value}),className:"w-full bg-[#2d2d2d] text-white p-2 rounded",placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),(0,c.jsx)("textarea",{value:v.about,onChange:e=>w({...v,about:e.target.value}),className:"w-full bg-[#2d2d2d] text-white p-2 rounded h-24",placeholder:"\u041e \u0441\u0435\u0431\u0435"}),(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"text",value:v.skills.join(", "),onChange:e=>w({...v,skills:e.target.value.split(",").map((e=>e.trim()))}),className:"w-full bg-[#2d2d2d] text-white p-2 rounded",placeholder:"\u041d\u0430\u0432\u044b\u043a\u0438 (\u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e)"})}),(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsx)("button",{onClick:async()=>{try{await u({displayName:v.displayName,photoURL:d.photoURL,about:v.about,skills:v.skills,email:d.email}),b((e=>({...e,displayName:v.displayName,about:v.about,skills:v.skills}))),P("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d"),y(!1)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f:",e),P("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f","error")}},className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),(0,c.jsx)("button",{onClick:()=>y(!1),className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700",children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)("div",{className:"bg-[#2d2d2d] rounded-lg p-4",children:(0,c.jsx)("table",{className:"w-full text-white",children:(0,c.jsxs)("tbody",{children:[(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-2 text-gray-400 w-1/3",children:"\u0418\u043c\u044f:"}),(0,c.jsx)("td",{className:"py-2",children:(null===j||void 0===j?void 0:j.displayName)||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-2 text-gray-400",children:"Email:"}),(0,c.jsx)("td",{className:"py-2",children:(null===j||void 0===j?void 0:j.email)||(null===d||void 0===d?void 0:d.email)})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-2 text-gray-400",children:"\u041e \u0441\u0435\u0431\u0435:"}),(0,c.jsx)("td",{className:"py-2",children:(null===j||void 0===j?void 0:j.about)||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-2 text-gray-400",children:"\u041d\u0430\u0432\u044b\u043a\u0438:"}),(0,c.jsx)("td",{className:"py-2",children:null!==j&&void 0!==j&&null!==(a=j.skills)&&void 0!==a&&a.length?(0,c.jsx)("div",{className:"flex flex-wrap gap-2",children:j.skills.map(((e,s)=>(0,c.jsx)("span",{className:"bg-blue-600 px-2 py-1 rounded-full text-sm",children:e},s)))}):"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u044b"})]})]})})}),(0,c.jsx)("button",{onClick:()=>y(!0),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 mt-4",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})})]}),(0,c.jsxs)("div",{className:"w-full border-t border-gray-700 pt-4",children:[(0,c.jsx)("h3",{className:"text-white text-lg mb-4",children:"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c"}),(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsx)("input",{type:"password",value:f,onChange:e=>N(e.target.value),className:"flex-1 bg-[#2d2d2d] text-white p-2 rounded",placeholder:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"}),(0,c.jsx)("button",{onClick:async()=>{try{if(f.length<6)return void P("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432","error");await m(f),P("\u041f\u0430\u0440\u043e\u043b\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d"),N("")}catch(e){P("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043c\u0435\u043d\u0435 \u043f\u0430\u0440\u043e\u043b\u044f","error")}},className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700",children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})]})]})})]}):(0,c.jsx)(r.A,{isOpen:!0,onClose:()=>x("/")})}}}]);
//# sourceMappingURL=213.26bdfbab.chunk.js.map